<!DOCTYPE html>
<html>

<head>

    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta content="always" name="referrer">
    <title>es6</title>
    <script src="../js/jquery.js"></script>
    <script>
        //promise - 许诺。
        //生命周期
        //pending进行中 
        //操作完成 用 .then() 对应两种结果（fulfilled 成了 rejected 不成）

        //回调函数传统写法：
        function func(cb){
            setTimeout(() => {
                cb && cb();
            },1000);
        }
        func(()=>{
            console.log(1);
            func(()=>{
                console.log(2);
                func(()=>{
                    console.log(3);
                    func(()=>{
                        console.log(4);
                    });
                });
            });
        });


        //promise写法
        function func2(){
            return new Promise((resolve,reject) => {
                setTimeout(()=>{
                    resolve();
                },1000);
            });
        }
        func2().then(()=>{
            console.log(10);
            return func2();
        }).then(()=>{
            console.log(20);
            return func2();
        }).then(()=>{
            console.log(30);
            return func2();
        }).then(()=>{
            console.log(40);
            return func2();
        })

        //一个简单的promist 封装的一个ajax
        let p = new Promise(function(resolve, reject){
            //这里封装异步代码， resolve 成功了，reject失败了。
            $.ajax({
                url: "data.txt",
                dataType: "json",
                success(arr){
                    resolve(arr);
                },
                error(err){
                    reject(err);
                }
            });
        });
        
        p.then(function(arr){
            console.log(arr);
        },(err)=>{
            console.log(err);
        });

        //用promise封装所有ajax （jquery已经做了，3以上，可以看返回值是否有promise）
        //箭头函数
    </script>

<body>
</body>

</html>